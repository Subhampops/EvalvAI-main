{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Subham%20Bhattachrya/Desktop/EvalvAI-main/lib/gemini.ts"],"sourcesContent":["import { GoogleGenerativeAI } from '@google/generative-ai'\r\n\r\nconst apiKey = process.env.GEMINI_API_KEY\r\n\r\nif (!apiKey) {\r\n    console.error('‚ùå GEMINI_API_KEY is not defined in environment variables')\r\n    console.error('Please check your .env.local file')\r\n    throw new Error('GEMINI_API_KEY is not defined in environment variables')\r\n}\r\n\r\nconsole.log('‚úÖ Gemini API Key loaded:', apiKey.substring(0, 10) + '...')\r\n\r\nconst genAI = new GoogleGenerativeAI(apiKey)\r\n\r\nexport const geminiModel = genAI.getGenerativeModel({ model: 'gemini-2.5-flash' })\r\n\r\nexport async function generateContent(prompt: string) {\r\n    try {\r\n        console.log('ü§ñ Calling Gemini API...')\r\n        const result = await geminiModel.generateContent(prompt)\r\n        const response = await result.response\r\n        const text = response.text()\r\n        console.log('‚úÖ Gemini API response received')\r\n        return text\r\n    } catch (error: any) {\r\n        console.error('‚ùå Gemini API Error:', error)\r\n        console.error('Error details:', {\r\n            message: error.message,\r\n            status: error.status,\r\n            statusText: error.statusText\r\n        })\r\n\r\n        // Provide more specific error messages\r\n        if (error.message?.includes('API_KEY_INVALID')) {\r\n            throw new Error('Invalid Gemini API key. Please check your API key in .env.local')\r\n        }\r\n        if (error.message?.includes('QUOTA_EXCEEDED')) {\r\n            throw new Error('Gemini API quota exceeded. Please try again later or upgrade your plan')\r\n        }\r\n        if (error.message?.includes('RATE_LIMIT')) {\r\n            throw new Error('Rate limit exceeded. Please wait a moment and try again')\r\n        }\r\n\r\n        throw new Error(`Failed to generate content from Gemini API: ${error.message}`)\r\n    }\r\n}\r\n\r\nexport async function generateStreamContent(prompt: string) {\r\n    try {\r\n        const result = await geminiModel.generateContentStream(prompt)\r\n        return result.stream\r\n    } catch (error: any) {\r\n        console.error('‚ùå Gemini API Stream Error:', error)\r\n        throw new Error(`Failed to generate stream from Gemini API: ${error.message}`)\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;AAEzC,IAAI,CAAC,QAAQ;IACT,QAAQ,KAAK,CAAC;IACd,QAAQ,KAAK,CAAC;IACd,MAAM,IAAI,MAAM;AACpB;AAEA,QAAQ,GAAG,CAAC,4BAA4B,OAAO,SAAS,CAAC,GAAG,MAAM;AAElE,MAAM,QAAQ,IAAI,oNAAkB,CAAC;AAE9B,MAAM,cAAc,MAAM,kBAAkB,CAAC;IAAE,OAAO;AAAmB;AAEzE,eAAe,gBAAgB,MAAc;IAChD,IAAI;QACA,QAAQ,GAAG,CAAC;QACZ,MAAM,SAAS,MAAM,YAAY,eAAe,CAAC;QACjD,MAAM,WAAW,MAAM,OAAO,QAAQ;QACtC,MAAM,OAAO,SAAS,IAAI;QAC1B,QAAQ,GAAG,CAAC;QACZ,OAAO;IACX,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,QAAQ,KAAK,CAAC,kBAAkB;YAC5B,SAAS,MAAM,OAAO;YACtB,QAAQ,MAAM,MAAM;YACpB,YAAY,MAAM,UAAU;QAChC;QAEA,uCAAuC;QACvC,IAAI,MAAM,OAAO,EAAE,SAAS,oBAAoB;YAC5C,MAAM,IAAI,MAAM;QACpB;QACA,IAAI,MAAM,OAAO,EAAE,SAAS,mBAAmB;YAC3C,MAAM,IAAI,MAAM;QACpB;QACA,IAAI,MAAM,OAAO,EAAE,SAAS,eAAe;YACvC,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,IAAI,MAAM,CAAC,4CAA4C,EAAE,MAAM,OAAO,EAAE;IAClF;AACJ;AAEO,eAAe,sBAAsB,MAAc;IACtD,IAAI;QACA,MAAM,SAAS,MAAM,YAAY,qBAAqB,CAAC;QACvD,OAAO,OAAO,MAAM;IACxB,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM,IAAI,MAAM,CAAC,2CAA2C,EAAE,MAAM,OAAO,EAAE;IACjF;AACJ"}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Subham%20Bhattachrya/Desktop/EvalvAI-main/app/api/evaluate-answer/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { generateContent } from '@/lib/gemini'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { question, userAnswer, correctAnswer, category } = await request.json()\n\n    const prompt = `You are an expert evaluator for ${category} interview questions. Evaluate the user's answer.\n\nQuestion: ${question}\nCorrect/Sample Answer: ${correctAnswer}\nUser's Answer: ${userAnswer}\n\nEvaluate the user's answer and respond ONLY with valid JSON in this format:\n{\n  \"isCorrect\": <true or false>,\n  \"feedback\": \"<encouraging feedback explaining what was good and what could be improved>\",\n  \"matchPercentage\": <number 0-100 indicating how close the answer is to the correct one>\n}\n\nBe encouraging and specific in your feedback. Consider partial credit for partially correct answers.`\n\n    const response = await generateContent(prompt)\n\n    // Parse the JSON response\n    let result\n    try {\n      const jsonMatch = response.match(/\\{[\\s\\S]*\\}/)\n      if (jsonMatch) {\n        result = JSON.parse(jsonMatch[0])\n      } else {\n        throw new Error('No JSON found')\n      }\n    } catch (parseError) {\n      // Fallback evaluation\n      const userAnswerLower = userAnswer.toLowerCase()\n      const correctAnswerLower = correctAnswer.toLowerCase()\n      const correctTerms = correctAnswerLower.split(' ').filter((w: string) => w.length > 3)\n      const matchedTerms = correctTerms.filter((term: string) => userAnswerLower.includes(term))\n      const matchPercentage = Math.round((matchedTerms.length / correctTerms.length) * 100)\n\n      result = {\n        isCorrect: matchPercentage > 60,\n        feedback: matchPercentage > 60\n          ? 'Good answer! You covered the key concepts.'\n          : 'Good effort! Review the sample answer for additional insights.',\n        matchPercentage\n      }\n    }\n\n    return NextResponse.json(result)\n  } catch (error: any) {\n    console.error('Answer Evaluation Error:', error)\n    return NextResponse.json(\n      { message: 'Failed to evaluate answer' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,UAAU,EAAE,aAAa,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE5E,MAAM,SAAS,CAAC,gCAAgC,EAAE,SAAS;;UAErD,EAAE,SAAS;uBACE,EAAE,cAAc;eACxB,EAAE,WAAW;;;;;;;;;oGASwE,CAAC;QAEjG,MAAM,WAAW,MAAM,IAAA,gKAAe,EAAC;QAEvC,0BAA0B;QAC1B,IAAI;QACJ,IAAI;YACF,MAAM,YAAY,SAAS,KAAK,CAAC;YACjC,IAAI,WAAW;gBACb,SAAS,KAAK,KAAK,CAAC,SAAS,CAAC,EAAE;YAClC,OAAO;gBACL,MAAM,IAAI,MAAM;YAClB;QACF,EAAE,OAAO,YAAY;YACnB,sBAAsB;YACtB,MAAM,kBAAkB,WAAW,WAAW;YAC9C,MAAM,qBAAqB,cAAc,WAAW;YACpD,MAAM,eAAe,mBAAmB,KAAK,CAAC,KAAK,MAAM,CAAC,CAAC,IAAc,EAAE,MAAM,GAAG;YACpF,MAAM,eAAe,aAAa,MAAM,CAAC,CAAC,OAAiB,gBAAgB,QAAQ,CAAC;YACpF,MAAM,kBAAkB,KAAK,KAAK,CAAC,AAAC,aAAa,MAAM,GAAG,aAAa,MAAM,GAAI;YAEjF,SAAS;gBACP,WAAW,kBAAkB;gBAC7B,UAAU,kBAAkB,KACxB,+CACA;gBACJ;YACF;QACF;QAEA,OAAO,8KAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,8KAAY,CAAC,IAAI,CACtB;YAAE,SAAS;QAA4B,GACvC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}